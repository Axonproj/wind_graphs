#/bin/bash

export METOFFICE_API_KEY="eyJ4NXQjUzI1NiI6Ik5XVTVZakUxTkRjeVl6a3hZbUl4TkdSaFpqSmpOV1l6T1dGaE9XWXpNMk0yTWpRek5USm1OVEE0TXpOaU9EaG1NVFJqWVdNellXUm1ZalUyTTJJeVpBPT0iLCJraWQiOiJnYXRld2F5X2NlcnRpZmljYXRlX2FsaWFzIiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ==.eyJzdWIiOiJyYXkucnVzc2VsbEBnbWFpbC5jb21AY2FyYm9uLnN1cGVyIiwiYXBwbGljYXRpb24iOnsib3duZXIiOiJyYXkucnVzc2VsbEBnbWFpbC5jb20iLCJ0aWVyUXVvdGFUeXBlIjpudWxsLCJ0aWVyIjoiVW5saW1pdGVkIiwibmFtZSI6InNpdGVfc3BlY2lmaWMtMjlmYjJhZmMtM2VmYS00NjUzLWE3MmYtYWJjZTM2OTk4NjU1IiwiaWQiOjI4Mzk1LCJ1dWlkIjoiOGE4M2U2YjYtZTcxMi00NDlkLWFiOGEtOTVjODM0MmE0NWMzIn0sImlzcyI6Imh0dHBzOlwvXC9hcGktbWFuYWdlci5hcGktbWFuYWdlbWVudC5tZXRvZmZpY2UuY2xvdWQ6NDQzXC9vYXV0aDJcL3Rva2VuIiwidGllckluZm8iOnsid2RoX3NpdGVfc3BlY2lmaWNfZnJlZSI6eyJ0aWVyUXVvdGFUeXBlIjoicmVxdWVzdENvdW50IiwiZ3JhcGhRTE1heENvbXBsZXhpdHkiOjAsImdyYXBoUUxNYXhEZXB0aCI6MCwic3RvcE9uUXVvdGFSZWFjaCI6dHJ1ZSwic3Bpa2VBcnJlc3RMaW1pdCI6MCwic3Bpa2VBcnJlc3RVbml0Ijoic2VjIn19LCJrZXl0eXBlIjoiUFJPRFVDVElPTiIsInN1YnNjcmliZWRBUElzIjpbeyJzdWJzY3JpYmVyVGVuYW50RG9tYWluIjoiY2FyYm9uLnN1cGVyIiwibmFtZSI6IlNpdGVTcGVjaWZpY0ZvcmVjYXN0IiwiY29udGV4dCI6Ilwvc2l0ZXNwZWNpZmljXC92MCIsInB1Ymxpc2hlciI6IkphZ3Vhcl9DSSIsInZlcnNpb24iOiJ2MCIsInN1YnNjcmlwdGlvblRpZXIiOiJ3ZGhfc2l0ZV9zcGVjaWZpY19mcmVlIn1dLCJ0b2tlbl90eXBlIjoiYXBpS2V5IiwiaWF0IjoxNzYxNDA5MjQzLCJqdGkiOiI5ZGEyZTFmZi1iNzY1LTRhOTEtYjBmYi1lNGJmOWI4ZDZhYmQifQ==.hODmk1AiX07tGpClR2rnHtqjcqQg6NsUUDWOuKLqa3-0U8j1vlKV17HasWlA981lsE4bIh0t2yrtN5rqhIla0TlwNyAsDYoenhrRNcY_QA-dw_1u8NsW3ne2jHj9sqeUenbMEsj5Y1yNZV28uTGWqSKChY2SV3RypyRdWqf4kGZCZVqiT5rMfer71GonkcRm-1qel0AzGZFbWoCvRyccz9lkVOPfeWO08l_hM1yzQA3pVxjlIqjOsPIWPkNfy_kNqTJRGpbdO5IWyI7qbT5aK1VnEUPcluzj88x0THZo76yExX9vz_K5jd2RL6N1h7WltJo3QjoX0IvaDIXWyVushA=="

if date -v+1d +"%Y%m%d" >/dev/null 2>&1; then
    # macOS / BSD date
    tomorrow=$(date -v+1d +"%Y%m%d")
else
    # Linux / GNU date
    tomorrow=$(date -d "tomorrow" +"%Y%m%d")
fi

perl ./get_forecast.pl -k $METOFFICE_API_KEY -y 50.78 -x -1.28 -t hourly > data/${tomorrow}_bramble_forecast.json
